<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.40">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>dsOMOP COPD Example â€“ DataSHIELD Workshop</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../chapters/datashield.html" rel="prev">
<link href="../favicon.ico" rel="icon">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-549806ee2085284f45b00abea8c6df48.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-626149efe8f5d16e1d391ba177679bf0.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="../../docs/custom.css">
</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../chapters/dsomop.html"><span class="chapter-title">dsOMOP COPD Example</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header sidebar-header-stacked">
      <a href="../index.html" class="sidebar-logo-link">
      <img src="../logo.svg" alt="" class="sidebar-logo py-0 d-lg-inline d-none">
      </a>
    <div class="sidebar-title mb-0 py-0">
      <a href="../">DataSHIELD Workshop</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/isglobal-brge/workshop_ICO" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
    <div class="dropdown">
      <a href="" title="Share" id="quarto-navigation-tool-dropdown-0" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" role="link" aria-label="Share"><i class="bi bi-share"></i></a>
      <ul class="dropdown-menu" aria-labelledby="quarto-navigation-tool-dropdown-0">
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://twitter.com/intent/tweet?url=|url|">
              <i class="bi bi-twitter pe-1"></i>
            Twitter
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://www.linkedin.com/sharing/share-offsite/?url=|url|">
              <i class="bi bi-linkedin pe-1"></i>
            LinkedIn
            </a>
          </li>
      </ul>
    </div>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Workshop Introduction</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/datashield.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">DataSHIELD Workshop</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/dsomop.html" class="sidebar-item-text sidebar-link active"><span class="chapter-title">dsOMOP COPD Example</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#libraries" id="toc-libraries" class="nav-link active" data-scroll-target="#libraries">Libraries</a></li>
  <li><a href="#connection" id="toc-connection" class="nav-link" data-scroll-target="#connection">Connection</a></li>
  <li><a href="#setup" id="toc-setup" class="nav-link" data-scroll-target="#setup">Setup</a></li>
  <li><a href="#data-catalogs" id="toc-data-catalogs" class="nav-link" data-scroll-target="#data-catalogs">Data catalogs</a></li>
  <li><a href="#data-retrieval" id="toc-data-retrieval" class="nav-link" data-scroll-target="#data-retrieval">Data retrieval</a></li>
  <li><a href="#data-preparation" id="toc-data-preparation" class="nav-link" data-scroll-target="#data-preparation">Data preparation</a></li>
  <li><a href="#analysis" id="toc-analysis" class="nav-link" data-scroll-target="#analysis">Analysis</a></li>
  <li><a href="#logout" id="toc-logout" class="nav-link" data-scroll-target="#logout">Logout</a></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/isglobal-brge/workshop_ICO/issues/new" class="toc-action"><i class="bi bi-github"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-title">dsOMOP COPD Example</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="libraries" class="level1">
<h1>Libraries</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(DSI)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(DSOpal)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dsBaseClient)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dsOMOPClient)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dsOMOPHelper)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="connection" class="level1">
<h1>Connection</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>builder <span class="ot">&lt;-</span> <span class="fu">newDSLoginBuilder</span>()</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>builder<span class="sc">$</span><span class="fu">append</span>(<span class="at">server=</span><span class="st">"opal-demo"</span>,</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>              <span class="at">url=</span><span class="st">"https://opal-demo.obiba.org/"</span>,</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>              <span class="at">user=</span><span class="st">"dsuser"</span>,</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>              <span class="at">password=</span><span class="st">"P@ssw0rd"</span>,</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>              <span class="at">driver =</span> <span class="st">"OpalDriver"</span>,</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>              <span class="at">profile =</span> <span class="st">"omop"</span>)</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>logindata <span class="ot">&lt;-</span> builder<span class="sc">$</span><span class="fu">build</span>()</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>conns <span class="ot">&lt;-</span> <span class="fu">datashield.login</span>(<span class="at">logins=</span>logindata)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="setup" class="level1">
<h1>Setup</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>o <span class="ot">&lt;-</span> <span class="fu">ds.omop.helper</span>(</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">connections =</span> conns,</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">resource =</span> <span class="st">"omop_demo.mimiciv"</span>, </span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">symbol =</span> <span class="st">"mimiciv"</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="data-catalogs" class="level1">
<h1>Data catalogs</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>condition_list <span class="ot">&lt;-</span> o<span class="sc">$</span><span class="fu">concepts</span>(<span class="st">"condition_occurrence"</span>)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>condition_list</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$`opal-demo`
    concept_id                                                 concept_name
1        27674                                          Nausea and vomiting
2        29735                                         Candidiasis of mouth
3        31317                                                    Dysphagia
4        73553                                                  Arthropathy
5        75576                                     Irritable bowel syndrome
6        75860                                                 Constipation
7        77670                                                   Chest pain
8        78232                                          Shoulder joint pain
9        79864                                           Hematuria syndrome
10       80180                                               Osteoarthritis
11       80502                                                 Osteoporosis
12       80951                               Candidiasis of urogenital site
13       81611                                Diverticular disease of colon
14       81902                             Urinary tract infectious disease
15      132736                                                   Bacteremia
16      132797                                                       Sepsis
17      134736                                                     Backache
18      134765                                                     Cachexia
19      138384                                      Acquired hypothyroidism
20      140673                                               Hypothyroidism
21      192357                                              Paralytic ileus
22      192450                                           Retention of urine
23      192671                                  Gastrointestinal hemorrhage
24      192673                          Vascular insufficiency of intestine
25      192680                                          Portal hypertension
26      193688                           Clostridioides difficile infection
27      193782                                      End-stage renal disease
28      195306                                             Gastroduodenitis
29      195562                                                  Hemorrhoids
30      195581                                          Peritoneal adhesion
31      196236                                                 Septic shock
32      196463                                          Alcoholic cirrhosis
33      196523                                                     Diarrhea
34      197320                                          Acute kidney injury
35      197444                        Vascular complication of medical care
36      197494                                            Viral hepatitis C
37      197672                                         Urinary incontinence
38      197925                                Hemorrhage of rectum and anus
39      197950                              Cellulitis and abscess of trunk
40      198571                                            Cardiogenic shock
41      198678                                Intestinal infectious disease
42      198964                                          Chronic hepatitis C
43      199074                                           Acute pancreatitis
44      200219                                               Abdominal pain
45      200451                          Chronic passive congestion of liver
46      200528                                                      Ascites
47      200618                                          Postoperative shock
48      201061                                         Diaphragmatic hernia
49      201826                                     Type 2 diabetes mellitus
50      254061                                             Pleural effusion
51      255573                             Chronic obstructive lung disease
52      255848                                                    Pneumonia
53      259992                              Ventilator associated pneumonia
54      261600                                        Acute pulmonary edema
55      261880                                                  Atelectasis
56      313217                                          Atrial fibrillation
57      314054                                        Aortic valve disorder
58      314665                                               Atrial flutter
59      314666                                    Old myocardial infarction
60      315078                                                 Palpitations
61      315286                               Chronic ischemic heart disease
62      315831                              Chronic pulmonary heart disease
63      316135                                       Atrioventricular block
64      316139                                                Heart failure
65      317002                                           Low blood pressure
66      317003                                          Compression of vein
67      317009                                                       Asthma
68      317576                                    Coronary arteriosclerosis
69      318736                                                     Migraine
70      318772                                      Disorder of pericardium
71      318800                              Gastroesophageal reflux disease
72      319041                                      Orthostatic hypotension
73      319049                                    Acute respiratory failure
74      319835                                     Congestive heart failure
75      319843                                        Mitral valve disorder
76      319844                                 Acute ischemic heart disease
77      320128                                       Essential hypertension
78      321052                                  Peripheral vascular disease
79      321462                                         Cardiac complication
80      321887                                           Disorder of artery
81      372448                                        Loss of consciousness
82      372887                                            Disorder of brain
83      372892                                     Metabolic encephalopathy
84      373764                                         Toxic encephalopathy
85      373995                                                     Delirium
86      375519                                           Alcohol withdrawal
87      376690                                               Cerebral edema
88      376713                                          Cerebral hemorrhage
89      377091                                                      Seizure
90      378253                                                     Headache
91      380378                                                     Epilepsy
92      432545                                 Bacterial infectious disease
93      432585                                   Blood coagulation disorder
94      432867                                               Hyperlipidemia
95      432870                                    Thrombocytopenic disorder
96      432875                             Anemia due to chronic blood loss
97      432881                                                 Pancytopenia
98      433163                                 Deficiency of macronutrients
99      433736                                                      Obesity
100     433753                                                Alcohol abuse
101     433968                                                  Candidiasis
102     434004                                                 Hypervolemia
103     434056                      Late effects of cerebrovascular disease
104     434547                           Complication of surgical procedure
105     434610                                                 Hyperkalemia
106     434814        Late effect of medical and surgical care complication
107     434894                                 Acute posthemorrhagic anemia
108     435243                                           Alcohol dependence
109     435515                          Hypo-osmolality and or hyponatremia
110     435517                                                     Acidosis
111     435788                            Disorder of phosphorus metabolism
112     435796                                                  Dehydration
113     435829                             Rheumatic disease of heart valve
114     436073                                           Psychotic disorder
115     436096                                                 Chronic pain
116     436222                                        Altered mental status
117     436238 Elevated level of transaminase and lactic acid dehydrogenase
118     436659                                       Iron deficiency anemia
119     436676                                Posttraumatic stress disorder
120     436962                                                     Insomnia
121     437233                                             Multiple myeloma
122     437247                                    Anemia of chronic disease
123     437264                                  Tobacco dependence syndrome
124     437312                                                     Bleeding
125     437382                                                Urine finding
126     437390                                                    Hypoxemia
127     437474                                      Postoperative infection
128     437579                           Paroxysmal ventricular tachycardia
129     437663                                                        Fever
130     437779                             Streptococcal infectious disease
131     437827                                    Pure hypercholesterolemia
132     437833                                                  Hypokalemia
133     438064                       Bacterial infection due to Pseudomonas
134     438398                                                 Leukocytosis
135     438725                             Disorder of magnesium metabolism
136     438730                                                    Alkalosis
137     439005                              Chronic alcoholism in remission
138     439408                                          Graft complications
139     439696 Hypertensive heart and renal disease with (congestive) he...
140     439777                                                       Anemia
141     440320                            Infection due to Escherichia coli
142     440383                                          Depressive disorder
143     440424                                                      Aphasia
144     440530                                      Oropharyngeal dysphagia
145     440674                                                         Gout
146     440940        Methicillin resistant Staphylococcus aureus infection
147     441258                                 Anemia in neoplastic disease
148     441536                             Mixed acid-base balance disorder
149     441829                         Hyperosmolality and or hypernatremia
150     442019                                    Complication of procedure
151     442077                                             Anxiety disorder
152     442588                             Obstructive sleep apnea syndrome
153     443211        Benign prostatic hyperplasia with outflow obstruction
154     443238                                      Diabetic - poor control
155     443344                                          Barrett's esophagus
156     443447                                       Iatrogenic hypotension
157     443530                                                 Hematochezia
158     443597                               Chronic kidney disease stage 3
159     443612                               Chronic kidney disease stage 4
160     443734                 Ketoacidosis due to type 2 diabetes mellitus
161     444044                                       Acute tubular necrosis
162     444070                                                  Tachycardia
163     444100                                                Mood disorder
164     444101                                   Hypertensive heart failure
165     444406                              Acute subendocardial infarction
166     764123   Atherosclerosis of coronary artery without angina pectoris
167    4008576                       Diabetes mellitus without complication
168    4052648                                                   Disability
169    4064161                                           Cirrhosis of liver
170    4064452                                     ECG: atrial fibrillation
171    4065288                                          EKG: atrial flutter
172    4079687                                         Tumor lysis syndrome
173    4088998                                 AV sequential pacing pattern
174    4089488                                        Atrial pacing pattern
175    4092038                                   Ventricular pacing pattern
176    4094822                            Foreign body in respiratory tract
177    4101362                                      Finding of urine output
178    4126119                                            Toxic nephropathy
179    4138456                                       ECG: sinus bradycardia
180    4140598                                       ECG: sinus tachycardia
181    4141820                                        ECG: sinus arrhythmia
182    4144111          Gastroesophageal reflux disease without esophagitis
183    4145510                            EKG: supraventricular tachycardia
184    4145513                                            ECG: sinus rhythm
185    4150981                                              Drug resistance
186    4154290                               Paroxysmal atrial fibrillation
187    4175154                    Disorder of the peripheral nervous system
188    4182210                                                     Dementia
189    4187218                         Pneumonitis due to inhaled substance
190    4188331                                      Chronic pulmonary edema
191    4193704                Type 2 diabetes mellitus without complication
192    4209423                                          Nicotine dependence
193    4229440                             Chronic congestive heart failure
194    4232495                                       Primary cardiomyopathy
195    4233565 Severe protein-calorie malnutrition (Gomez: less than 60 ...
196    4245975                                              Hepatic failure
197    4256228                                          Respiratory failure
198    4268911                                                Disorientated
199    4270024         Acute non-ST segment elevation myocardial infarction
200    4282096                             Major depression, single episode
201    4286201                                     Schizoaffective disorder
202    4295261                                         Postmenopausal state
203    4311499              Primary malignant neoplasm of respiratory tract
204    4322175                    Late effect of complications of procedure
205    4332246                                                     Aneurysm
206    4339214                             Secondary pulmonary hypertension
207    4353709                               Intracerebral vascular finding
208   36712779                   Chronic total occlusion of coronary artery
209   36712821                                     Postprocedural infection
210   36712982 Unstable angina co-occurrent and due to coronary arterios...
211   37016114               Acute on chronic hypoxemic respiratory failure
212   37016349                Hyperglycemia due to type 2 diabetes mellitus
213   37017432               Polyneuropathy due to type 2 diabetes mellitus
214   37116361                            Accidental wound during procedure
215   37311319                                                  Hypovolemia
216   37394658                                                Severe sepsis
217   37395564                                Hypoxemic respiratory failure
218   40321716                                   Secondary thrombocytopenia
219   40479192                               Chronic systolic heart failure
220   40479576                              Chronic diastolic heart failure
221   40480602                      Acute on chronic systolic heart failure
222   40481043                     Acute on chronic diastolic heart failure
223   40481762         Hemiplegia as late effect of cerebrovascular disease
224   40481919                                     Coronary atherosclerosis
225   40482801                       Type II diabetes mellitus uncontrolled
226   40487064                               Sepsis due to Escherichia coli
227   42537730                                Coronary artery graft present
228   42537748                                    Acquired absence of organ
229   42873170                            Dependence on supplemental oxygen
230   43022062              Cardiovascular system complication of procedure
231   43530681                                      Drug abuse in remission
232   43530690                   Foot ulcer due to type 2 diabetes mellitus
233   43530742 Paralytic syndrome on one side of the body as late effect...
234   43531578       Chronic kidney disease due to type 2 diabetes mellitus
235   44782421              Acute deep venous thrombosis of upper extremity
236   44782429                   Chronic kidney disease due to hypertension
237   44784217                                           Cardiac arrhythmia
238   44784439         Benign hypertensive renal disease with renal failure
239   44784631                               Pain due to neoplastic disease
240   45757363                 Hypoglycemia due to type 2 diabetes mellitus
241   45766207       Non-rheumatic mitral valve stenosis with regurgitation
242   45768812                             Anemia in chronic kidney disease
243   45768910                                         Uncomplicated asthma
244   46271022                                       Chronic kidney disease
245   46271075                          Acute hypoxemic respiratory failure
246   46273390                                     Dependence on respirator</code></pre>
</div>
</div>
</section>
<section id="data-retrieval" class="level1">
<h1>Data retrieval</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Define concept IDs</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>concepts <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">outcome =</span> <span class="dv">255573</span>,      <span class="co"># Chronic obstructive lung diease (condition)</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">predictor1 =</span> <span class="dv">4005823</span>,  <span class="co"># Tobacco use (observation)</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">predictor2 =</span> <span class="dv">317009</span>    <span class="co"># Asthma (condition)</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Get data</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>o<span class="sc">$</span><span class="fu">auto</span>(</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">table =</span> <span class="st">"condition_occurrence"</span>, </span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">concepts =</span> <span class="fu">c</span>(concepts<span class="sc">$</span>outcome, concepts<span class="sc">$</span>predictor2),</span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"condition_occurrence_id"</span>)</span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>o<span class="sc">$</span><span class="fu">auto</span>(</span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">table =</span> <span class="st">"observation"</span>, </span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">concepts =</span> concepts<span class="sc">$</span>predictor1,</span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"observation_id"</span>)</span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="data-preparation" class="level1">
<h1>Data preparation</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert variables to boolean</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (var <span class="cf">in</span> <span class="fu">c</span>(<span class="st">"tobacco_user"</span>, <span class="st">"asthma"</span>, <span class="st">"chronic_obstructive_lung_disease"</span>)) {</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>    id_type <span class="ot">&lt;-</span> <span class="cf">if</span>(var <span class="sc">==</span> <span class="st">"tobacco_user"</span>) <span class="st">"observation_id"</span> <span class="cf">else</span> <span class="st">"condition_occurrence_id"</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>    full_var <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"mimiciv$"</span>, var, <span class="st">"."</span>, id_type)</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Convert to numeric</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ds.asNumeric</span>(<span class="at">x.name =</span> full_var, <span class="at">newobj =</span> <span class="fu">paste0</span>(var, <span class="st">"_num"</span>), <span class="at">datasources =</span> conns)</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Convert to boolean</span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ds.Boole</span>(<span class="at">V1 =</span> <span class="fu">paste0</span>(var, <span class="st">"_num"</span>), <span class="at">V2 =</span> <span class="dv">0</span>, <span class="at">Boolean.operator =</span> <span class="st">"!="</span>, </span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>             <span class="at">numeric.output =</span> <span class="cn">TRUE</span>, <span class="at">na.assign =</span> <span class="dv">0</span>, <span class="at">newobj =</span> var)</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Create analysis table</span></span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a><span class="fu">ds.cbind</span>(</span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="fu">c</span>(<span class="st">"chronic_obstructive_lung_disease"</span>, <span class="st">"tobacco_user"</span>, <span class="st">"asthma"</span>),</span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">DataSHIELD.checks =</span> <span class="cn">FALSE</span>,</span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">newobj =</span> <span class="st">"analysis_table"</span>,</span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">datasources =</span> conns</span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$is.object.created
[1] "A data object &lt;analysis_table&gt; has been created in all specified data sources"

$validity.check
[1] "&lt;analysis_table&gt; appears valid in all sources"</code></pre>
</div>
</div>
</section>
<section id="analysis" class="level1">
<h1>Analysis</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">ds.glm</span>(</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">formula =</span> <span class="st">"chronic_obstructive_lung_disease ~ tobacco_user + asthma"</span>, </span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> <span class="st">"analysis_table"</span>, </span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">family =</span> <span class="st">"binomial"</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$Nvalid
[1] 100

$Nmissing
[1] 0

$Ntotal
[1] 100

$disclosure.risk
          RISK OF DISCLOSURE
opal-demo                  0

$errorMessage
          ERROR MESSAGES
opal-demo "No errors"   

$nsubs
[1] 100

$iter
[1] 18

$family

Family: binomial 
Link function: logit 


$formula
[1] "chronic_obstructive_lung_disease ~ tobacco_user + asthma"

$coefficients
               Estimate   Std. Error      z-value      p-value low0.95CI.LP
(Intercept)   -1.845827    0.3106304 -5.942196444 2.812281e-09    -2.454651
tobacco_user   1.152680    1.2635233  0.912274032 3.616245e-01    -1.323781
asthma       -17.548914 2953.9650106 -0.005940799 9.952600e-01 -5807.213946
             high0.95CI.LP         P_OR low0.95CI.P_OR high0.95CI.P_OR
(Intercept)      -1.237002 1.363636e-01     0.07909909       0.2249582
tobacco_user      3.629140 3.166667e+00     0.26612726      37.6803863
asthma         5772.116119 2.391132e-08     0.00000000             Inf

$dev
[1] 73.92114

$df
[1] 97

$output.information
[1] "SEE TOP OF OUTPUT FOR INFORMATION ON MISSING DATA AND ERROR MESSAGES"</code></pre>
</div>
</div>
</section>
<section id="logout" class="level1">
<h1>Logout</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">datashield.logout</span>(conns)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "î§‹";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../chapters/datashield.html" class="pagination-link" aria-label="DataSHIELD Workshop">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-title">DataSHIELD Workshop</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
  </div>
</nav>
</div> <!-- /content -->




<footer class="footer"><div class="nav-footer"><div class="nav-footer-center"><div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/isglobal-brge/workshop_ICO/issues/new" class="toc-action"><i class="bi bi-github"></i>Report an issue</a></li></ul></div></div></div></footer></body></html>